<!doctype html>
<title>SPDY Indicator</title>
<script>
  chrome.extension.onRequest.addListener(function (res, sender) {
    var tab = sender.tab;

    if (res.spdy) {
      // show page action
      chrome.pageAction.show(tab.id);

      // change icon
      chrome.pageAction.setIcon({
          path: 'icon-spdy.png'
        , tabId: tab.id
      });

      // change icon tooltip
      chrome.pageAction.setTitle({
          title: tab.url + ' is SPDY-enabled'
        , tabId: tab.id
      });
    } else {
      chrome.pageAction.hide(tab.id);
    }
  });
</script>
